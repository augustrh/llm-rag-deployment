apiVersion: batch/v1
kind: Job
metadata:
  name: postgres-extension-job
  namespace: ic-shared-rag-llm
  annotations:
    argocd.argoproj.io/sync-wave: "2"
    argocd.argoproj.io/hook: Sync
    argocd.argoproj.io/hook-delete-policy: BeforeHookCreation
spec:
  template:
    metadata:
      name: postgres-extension-pod
    spec:
      containers:
      - name: postgres-client
        image: registry.access.redhat.com/ubi8/ubi-minimal:latest
        command: ["/bin/sh", "-c"]
        args:
          - "oc rsh service/postgresql-service -n ic-shared-rag-llm psql -d vectordb -c 'CREATE EXTENSION vector;'"
      restartPolicy: Never
